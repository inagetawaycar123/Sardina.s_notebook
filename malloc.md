---
date: 2025.9.29
tags:
  - C语言
---

`malloc` 是 C 语言中用于**动态分配内存**的函数，主要用于在程序运行时根据需要申请内存空间。

	 int* result = (int*)malloc(2 * sizeof(int));

以这段代码为例，我们可知：
- `malloc`函数返回的是一个**指针**
- `malloc`自动返回void类型指针，因此调用`malloc`时，要先定义其指针类型，*定义指针类型要用**小括号***
- `malloc`后的小括号指明占用内存的大小，**通常用`sizeof()`函数**，而不是直接用诸如4这样的常数

另外，还有两个重点：
- 要判断分配内存是否成功
 ```c
	if (result == NULL) {
    // 处理分配失败（如打印错误信息、释放其他资源、退出程序）
    printf("内存分配失败！\n");
    exit(1);  // 需要包含 <stdlib.h>
	}
	```

- 要在最后释放内存，并且除去野指针
```c
	free(result);    // 释放内存
	result = NULL;   // 防止野指针
```
